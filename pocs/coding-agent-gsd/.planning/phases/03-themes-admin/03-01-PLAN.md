---
phase: 03-themes-admin
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [js/themes.js, js/board.js]
autonomous: true

must_haves:
  truths:
    - "Theme configuration objects exist with Classic, Neon, Retro themes"
    - "Board stores piece type (I,O,T,S,Z,J,L) not color string"
    - "applyTheme function changes currentTheme variable"
  artifacts:
    - path: "js/themes.js"
      provides: "Theme configuration and state"
      exports: ["THEMES", "currentTheme", "applyTheme", "THEME_ORDER"]
    - path: "js/board.js"
      provides: "Board logic with piece type storage"
      contains: "board[boardY][boardX] = piece.type"
  key_links:
    - from: "js/board.js"
      to: "lockPiece function"
      via: "stores piece.type instead of color"
      pattern: "board\\[boardY\\]\\[boardX\\] = piece\\.type"
---

<objective>
Create theme configuration system and refactor board to store piece types instead of colors.

Purpose: Foundation for theme-aware rendering. Board must store piece type so locked pieces update when theme changes. Themes define all colors used by renderer.

Output: js/themes.js with 3 theme configs, js/board.js modified to store piece type.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-themes-admin/03-RESEARCH.md

@js/board.js
@js/pieces.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create themes.js with 3 theme configurations</name>
  <files>js/themes.js</files>
  <action>
Create js/themes.js with:

1. THEMES object containing Classic, Neon, Retro themes. Each theme has:
   - name: display name
   - colors object with: background, grid, sidebar, I, O, T, S, Z, J, L

2. Color values from RESEARCH.md:
   Classic: background=#0f0f1a, grid=#2a2a4a, sidebar=#16162a, I=#00f0f0, O=#f0f000, T=#a000f0, S=#00f000, Z=#f00000, J=#0000f0, L=#f0a000
   Neon: background=#000000, grid=#00ff00, sidebar=#001100, I=#00ffff, O=#ffff00, T=#ff00ff, S=#00ff00, Z=#ff0000, J=#0000ff, L=#ff8800
   Retro: background=#f4e4c1, grid=#8b7355, sidebar=#d4c4a1, I=#5f9ea0, O=#daa520, T=#9370db, S=#3cb371, Z=#cd5c5c, J=#4682b4, L=#d2691e

3. THEME_ORDER array: ['classic', 'neon', 'retro']

4. let currentTheme = THEMES.classic (mutable state)

5. function applyTheme(themeName) that sets currentTheme if theme exists

Script tag for themes.js must load BEFORE render.js and main.js in index.html.
  </action>
  <verify>File js/themes.js exists with THEMES object containing 3 themes. Each theme has background, grid, sidebar, and all 7 piece colors.</verify>
  <done>THEMES.classic, THEMES.neon, THEMES.retro exist with correct color values. currentTheme initialized to classic. applyTheme function works.</done>
</task>

<task type="auto">
  <name>Task 2: Refactor board.js to store piece type instead of color</name>
  <files>js/board.js</files>
  <action>
Modify lockPiece function in js/board.js:

Current code stores color:
  const color = PIECES[piece.type].color;
  board[boardY][boardX] = color;

Change to store piece type:
  board[boardY][boardX] = piece.type;

Remove the unused `const color = PIECES[piece.type].color;` line.

This is a CRITICAL change per RESEARCH.md Pitfall 6: board currently stores piece.color which prevents theme changes from affecting locked pieces.
  </action>
  <verify>In js/board.js, lockPiece function stores piece.type (single letter like 'I', 'O', 'T') instead of color string.</verify>
  <done>lockPiece stores piece.type. No color variable in lockPiece function.</done>
</task>

<task type="auto">
  <name>Task 3: Update index.html to load themes.js</name>
  <files>index.html</files>
  <action>
Add script tag for themes.js in index.html. Must load BEFORE render.js since render.js will use currentTheme.

Order should be:
1. pieces.js (has PIECES definition)
2. board.js (uses PIECES)
3. themes.js (defines themes)
4. render.js (will use currentTheme)
5. input.js
6. main.js
  </action>
  <verify>themes.js script tag appears before render.js in index.html</verify>
  <done>index.html loads themes.js in correct order</done>
</task>

</tasks>

<verification>
1. Open browser console, verify THEMES object exists with 3 themes
2. Verify currentTheme.colors.I returns '#00f0f0' (classic cyan)
3. Verify applyTheme('neon') changes currentTheme
4. Start game, lock a piece, inspect board array - should contain 'I' or 'T' etc, not color strings
</verification>

<success_criteria>
- js/themes.js exists with THEMES, currentTheme, applyTheme, THEME_ORDER
- js/board.js lockPiece stores piece.type
- index.html loads themes.js before render.js
- Game still plays correctly (pieces fall, lock, clear)
</success_criteria>

<output>
After completion, create `.planning/phases/03-themes-admin/03-01-SUMMARY.md`
</output>
